<!DOCTYPE html>
	<head>
		<title>StarGate_Uploader</title>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/jasny-bootstrap/3.0.1-p7/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jasny-bootstrap/3.0.1-p7/css/bootstrap.min.css">
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jasny-bootstrap/3.0.1-p7/css/bootstrap-theme.min.css">
	</head>
	<body style="background: black url('img/background.png') no-repeat; background-position: center top; background-size: 100%;">
		<div class="container">
			<div class="row">
				<div class="well col-lg-7 col-md-7 col-sm-12 col-xs-12">
					<legend>Uploader un Film ou une Série:</legend>
					<p>
						<div class="control-group">
							<div class="controls">
								<label class="radio-inline">
									<input type="radio" name="filmOrSerie" id="filmOrSerie" value="Films" checked disabled>
									Film
								</label>
								<label class="radio-inline">
									<input type="radio" name="filmOrSerie" id="filmOrSerie" value="Series" disabled>
									Série
								</label>
								<br /><br />
								<div class="row">
									<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
										<input type="text" name="nomFilm" id="nomFilm" class="form-control" placeholder="Nom original du Film">
									</div>
									<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
										<input type="number" name="anneFilm" id="anneFilm" class="form-control" placeholder="Année du Film"><br />
									</div>
								</div>
								<div class="fileinput fileinput-new" data-provides="fileinput">
									<div class="input-group">
										<div class="form-control uneditable-input span3" data-trigger="fileinput">
											<i class="glyphicon glyphicon-file fileinput-exists"></i>
											<span class="fileinput-filename"></span>
										</div>
										<span class="input-group-addon btn btn-default btn-file">
											<span class="fileinput-new">Sélectionner fichier</span>
											<span class="fileinput-exists">Changer</span>
											<input type="file" id="file_upload" multiple>
										</span>
										<a href="#" class="input-group-addon btn btn-default fileinput-exists" data-dismiss="fileinput">Supprimer</a>
									</div>
								</div><br />
								<button type="button" id="submit_btn" class="btn btn-primary" disabled><span class="glyphicon glyphicon-hdd"></span> Envoyer le fichier</button>
								<div class="btn-group pull-right">
									<button type="button" id="resume_btn" class="btn btn-success" disabled><span class="glyphicon glyphicon-play"></span> Reprise</button>
									<button type="button" id="pause_btn" class="btn btn-warning" disabled><span class="glyphicon glyphicon-pause"></span> Pause</button>
									<button type="button" id="cancel_btn" class="btn btn-danger" disabled><span class="glyphicon glyphicon-stop"></span> Cancel</button>
								</div>
							</div>
						</div>
					</p>
				</div>
				<div class="well col-lg-4 col-md-4 col-lg-offset-1 col-md-offset-1">
					<legend>Infos du NAS:</legend>
					<p>
						<div class="row">
							<div id="infosDisqueUsed">
								<strong>Pourcentage d'utilisation du disque dur</strong> :
								<span id="pourcentageDisqueUsed" >--</span> %
							</div>
							<div class="progress progress-striped">
								<div id="progress_Success" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="50" style="width: 0%"></div>
								<div id="progress_Warning" class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="25" style="width: 0%"></div>
								<div id="progress_Danger" class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="25" style="width: 0%"></div>
							</div>
							<div id="infosFreqProc">
								<strong>Frequence du Processeur</strong> :
								<span id="FreqProc" >--</span> Mhz
							</div>
							<div class="progress progress-striped">
								<div id="progress_Success_FreqProc" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="50" style="width: 0%">
								</div>
								<div id="progress_Warning_FreqProc" class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="25" style="width: 0%">
								</div>
								<div id="progress_Danger_FreqProc" class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="25" style="width: 0%">
								</div>
							</div>
							<div id="infosDisqueUse">
								<strong>Temperature</strong> :
								<span id="Temperature" >--</span> 'C
							</div>
							<div class="progress progress-striped">
								<div id="progress_Success_Temperature" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="50" style="width: 0%"></div>
								<div id="progress_Warning_Temperature" class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="25" style="width: 0%"></div>
								<div id="progress_Danger_Temperature" class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="25" style="width: 0%"></div>
							</div>
							<div id="infosNbrFilm" class="pull-left">
								<strong>Nombre de Film(s)</strong> :
								<span id="nbrFilm" >--</span>
							</div>
							<div id="infosNbrSerie" class="pull-right">
								<strong>Nombre de Série(s)</strong> :
								<span id="nbrSerie" >--</span>
							</div>
							<div id="infosNbrMusique" class="pull-left">
								<strong>Nombre de Musique(s)</strong> :
								<span id="nbrMusique" >--</span>
							</div>
							<div id="infosNbrImage" class="pull-right">
								<strong>Nombre d'Image(s)</strong> :
								<span id="nbrImage" >--</span>
							</div>
							<button type="button" id="list_film_btn" class="btn btn-primary" disabled><span class="glyphicon glyphicon-eye-open"></span> Liste des Films / Séries</button>
						</div>
					</p>
				</div>
			</div>

			<div class="well row">
				<div id="infosChunking">
					<strong>Chunking</strong> :
					<span id="pourcentageChungink" >--</span> %
				</div>
				<div class="progress progress-striped active">
					<div id="progress_Chunking" class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
				</div>
				<div id="infosUpload">
					<strong>Progression de l'Upload</strong> :
					<span id="pourcentageUpload" >--</span> %
				</div>
				<div class="progress progress-striped active">
					<div id="progress_Normal" class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
					</div>
				</div>
				<div class="pull-right">
					<strong>/!\ Fonctionnalité encore en BETA /!\</strong>
				</div>
				<div id="infosFichier">
					<strong>Taille du fichier</strong> :
					<span id="tailleFichier" >--</span>
				</div>
				<div class="pull-right">
					<strong>Temps estimé</strong> :
					<span id="temps_Estimer_Day" >--</span> jour(s)
					<span id="temps_Estimer_Hour">--</span> heure(s)
					<span id="temps_Estimer_Min" >--</span> minutes
					<span id="temps_Estimer_Sec" >--</span> secondes
				</div>
				<div id="count">
					<strong>Temps écoulé</strong> :
					<span id="count_Day" >--</span> jour(s)
					<span id="count_Hour">--</span> heure(s)
					<span id="count_Min" >--</span> minutes
					<span id="count_Sec" >--</span> secondes
				</div>
			</div>
			
			<div id="ModalFileUploaded" class="modal fade bs-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
			  <div class="modal-dialog modal-sm">
				<div class="modal-content">
					<div class="modal-header">
						<h4 class="modal-title text-success">Fichier : <span id="nom_Envoyer">...</span>, envoyé avec succès !</h4>
					</div>
					<div class="modal-body alert-success">
						Taille du fichier : <span id="taille_Envoyer" class="badge">...</span>
						<br />
						Temps écoulé : 
						<span id="temps_Envoyer_Day" class="badge">...</span> jours
						<span id="temps_Envoyer_Hour" class="badge">...</span> heures
						<span id="temps_Envoyer_Min" class="badge">...</span> minutes
						<span id="temps_Envoyer_Sec" class="badge">...</span> secondes
					</div>
				</div>
			  </div>
			</div>
			
			<div class="row">
				<h4>
					<div id="countDown" class="alert alert-info">
						<strong>Temps restant pour Game of Thrones Saison 4</strong> : 
						<span id="remaining_day" class="badge">--</span> jours
						<span id="remaining_hour" class="badge">--</span> heures
						<span id="remaining_min" class="badge">--</span> minutes
						<span id="remaining_sec" class="badge">--</span> secondes
					</div>
				</h4>
			</div>
			
			<div class="row">
				<img class="thumbnail" src="img/attendu.png" alt="image d'un film ou d'une série attendue">
			</div>
			
			<audio preload="auto" id="son">
			  <source src="son/beep.mp3" type="audio/mp3">
			  <source src="son/beep.ogg" type="audio/ogg">
			</audio>
			
			<script src="resumable.js"></script>
			<script src="socket.io.js"></script>
			
			<script>
				$(document).ready(function() {
					var socket = io();
					
					var file_input = $('#file_upload'),
						submit_btn = $('#submit_btn'),
						resume_btn = $('#resume_btn'),
						pause_btn = $('#pause_btn'),
						cancel_btn = $('#cancel_btn'),
						list_film_btn = $('#list_film_btn'),
						filmOrSerie = $('input[name=filmOrSerie]:checked').val(),
						nomFinal = $('#nomFilm').val(),
						anneFilm = $('#anneFilm').val(),
						progression = 0,
						calculTmp = 0;
					
					// Supprime tous les caracères qui ne sont pas numeriques
					$('#anneFilm').keyup(function() {
						var reg = /\D/,
						test = "";
						anneFilm = $('#anneFilm').val();
						test = anneFilm.replace(reg, '');
						$('#anneFilm').val(test);
					});
					
					socket.on('majInfoDisqueUsed', function(data){
						var data1 = 0,
							data2 = 0,
							data3 = 0;
						
						//console.debug('data Disque Used : ' + data);
						$('#pourcentageDisqueUsed').text(data);
						if (data <= 50)
						{
							data1 = data;
							data2 = 0;
							data3 = 0;
						}
						if ((data > 50) && (data <= 75))
						{
							data1 = 50;
							data2 = data - 50;
							data3 = 0;
						}
						if (data > 75)
						{
							data1 = 50;
							data2 = 25;
							data3 = data - 75;									
						}
						$('#progress_Success').css('width', data1 + '%');
						$('#progress_Warning').css('width', data2 + '%');
						$('#progress_Danger').css('width', data3 + '%');
					});
					
					socket.on('majInfoFreqProc', function(data){
						var data1 = 0,
							data2 = 0,
							data3 = 0;
						
						data = data / 1000;
						
						//console.debug('data Freq CPU : ' + data + ' Mhz');
						$('#FreqProc').text(data);
						
						data = data / 10;
						
						if (data <= 50)
						{
							data1 = data;
							data2 = 0;
							data3 = 0;
						}
						if ((data >= 70) && (data <= 85))
						{
							data1 = 50;
							data2 = ((data - 50) / 85) * 25;
							//console.debug('data : ' + data);
							//console.debug('data2 : ' + data2);
							data3 = 0;
							
							//	71 = ?
							//	85 = 25
							
						}
						if ((data > 85) && (data < 95))
						{
							data1 = 50;
							data2 = 25;
							data3 = data - 85;
						}
						if (data >= 95)
						{
							data1 = 50;
							data2 = 25;
							data3 = 25;
						}
						$('#progress_Success_FreqProc').css('width', data1 + '%');
						$('#progress_Warning_FreqProc').css('width', data2 + '%');
						$('#progress_Danger_FreqProc').css('width', data3 + '%');
					});
					
					socket.on('majTemperature', function(data){
						var data1 = 0,
							data2 = 0,
							data3 = 0;
						
						//console.debug('data Temp : ' + data);
						$('#Temperature').text(data);
						if (data <= 40)
						{
							data1 = data + 10;
							data2 = 0;
							data3 = 0;
						}
						if ((data > 40) && (data <= 65))
						{
							data1 = 50;
							data2 = data - 30;
							data3 = 0;
						}
						if (data > 65)
						{
							data1 = 50;
							data2 = 25;
							data3 = data - 55;									
						}
						$('#progress_Success_Temperature').css('width', data1 + '%');
						$('#progress_Warning_Temperature').css('width', data2 + '%');
						$('#progress_Danger_Temperature').css('width', data3 + '%');
					});
					
					socket.on('majInfoNbrFilm', function(data){
						//console.debug('data nbrFilm : ' + ((data) - 1));
						$('#nbrFilm').text(((data) - 1));
					});
					
					socket.on('majInfoNbrSerie', function(data){
						//console.debug('data nbrSerie : ' + data);
						$('#nbrSerie').text(data);
					});
					
					socket.on('majInfoNbrMusique', function(data){
						//console.debug('data nbrMusique : ' + data);
						$('#nbrMusique').text(data);
					});
					
					/*socket.on('majInfoNbrImage', function(data){
						//console.debug('data nbrImage : ' + data);
						//$('#nbrImage').text(data);
					});*/

					file_input.on('change', onFilesSelected);
					
					/**
					 * Utility method to format bytes into the most logical magnitude (o, Ko, Mo,
					 * or Go, To).
					 */
					function formatBytes (bytes)
					{
						var units = ['o', 'Ko', 'Mo', 'Go', 'To'],
							i;
					 
						for (i = 0; bytes >= 1024 && i < 4; i++) {
							bytes /= 1024;
						}
					 
						return bytes.toFixed(2) + ' ' + units[i];
					}
					
					$('#resume_btn').click(function()
					{
						r.upload();
						$('#son')[0].play();
					});
					
					$('#pause_btn').click(function()
					{
						r.pause();
						$('#son')[0].play();
					});
					
					$('#cancel_btn').click(function()
					{
						r.cancel();
						countManager.raz();
						calculTmp = 0;
						
						$('#tailleFichier').text('--');
						$('#nomFilm').val('');
						$('#anneFilm').val('');
						$('.fileinput').fileinput('reset');
						
						$('title').text('StarGate_Uploader');
						
						$('#pourcentageChungink').text('--');
						$('#progress_Chunking').css('width', '0%');
						$('#pourcentageUpload').text('--');
						$('#progress_Normal').css('width', '0%');
						
						$('#temps_Estimer_Sec').text('--');
						$('#temps_Estimer_Min').text('--');
						$('#temps_Estimer_Hour').text('--');
						$('#temps_Estimer_Day').text('--');
					});
					
					$('#list_film_btn').click(function()
					{
						//window.location.replace('http://192.168.0.15:81/');
						//window.location.replace('http://dt-serveur0.no-ip.org:81/');
					});
					
					function onFilesSelected(e)
					{
						submit_btn.attr('disabled', false);
						
						$('#submit_btn').click(function()
						{
							submit_btn.attr('disabled', true);
							r.upload();
						});
					}
					
					var r = new Resumable({
						target:'/upload',
						chunkSize: 4 * 1024 * 1024,
						prioritizeFirstAndLastChunk: true,
						simultaneousUploads: 1
					});
					
					if (!r.support)
					{
						alert('Non supporté !!');
					}
					else
					{
						r.assignBrowse($('#file_upload'));
						
						r.on('fileSuccess', function(file){
							//console.debug('fileSuccess : ' + file);
							
							//alert('Fichier Success !!');
							$('#nom_Envoyer').text(nomFinal);
							$('#taille_Envoyer').text(formatBytes(r.getSize()));
							$('#temps_Envoyer').text(nomFinal);
							$('#ModalFileUploaded').modal('show');
							
							countManager.raz();
							r.cancel();
							calculTmp = 0;
							
							$('#tailleFichier').text('--');
							$('#nomFilm').val('');
							$('#anneFilm').val('');
							$('.fileinput').fileinput('reset');
							
							$('title').text('StarGate_Uploader');
							
							$('#pourcentageChungink').text('--');
							$('#progress_Chunking').css('width', '0%');
							$('#pourcentageUpload').text('--');
							$('#progress_Normal').css('width', '0%');
							
							$('#temps_Estimer_Sec').text('--');
							$('#temps_Estimer_Min').text('--');
							$('#temps_Estimer_Hour').text('--');
							$('#temps_Estimer_Day').text('--');
							
							// Indique à l'utilisateur que l'upload est terminé
							$('#son')[0].play();
						  });
						r.on('fileProgress', function(file){
							//console.debug('fileProgress : ' + file);
						  });
						r.on('fileAdded', function(file, event){
							console.debug('fileAdded : ' + file, event);
							
						  });
						r.on('filesAdded', function(array){
							console.debug('filesAdded : ' + array);
						  });
						r.on('fileRetry', function(file){
							console.debug('fileRetry : ' + file);
						  });
						r.on('fileError', function(file, message){
							console.debug(file, message);
							alert('FileError !!');
						  });
						r.on('uploadStart', function(){
							console.debug('uploadStart : ');
							
							// MAJ des valeur à envoyer
							filmOrSerie = $('input[name=filmOrSerie]:checked').val();
							nomFinal = $('#nomFilm').val();
							anneFilm = $('#anneFilm').val();
							r.opts.query = { film_Or_Serie: filmOrSerie, nom_Final: nomFinal, anne_Film: anneFilm };
							
							// Démarage du compteur et affichage du poid du fichier
							countManager.init();
							
							$('#tailleFichier').text(formatBytes(r.getSize()));
							
							// Activation des boutons "Pause", "Cancel"
							pause_btn.attr('disabled', false);
							cancel_btn.attr('disabled', false);
							
							// Désactivation du bouton "Resume"
							resume_btn.attr('disabled', true);
						  });
						r.on('complete', function(){
							//alert('Fichier Uploade !!');
							
							// Arret du compteur
							countManager.stop();
							
							// Désactivation de tous les boutons
							resume_btn.attr('disabled', true);
							pause_btn.attr('disabled', true);
							cancel_btn.attr('disabled', true);
							
							test.init();
						  });
						r.on('progress', function(){
							progression = (r.progress() * 100).toFixed(2);
							
							//console.debug('progress : ' + (r.progress() * 100));
							//console.debug('calculTmp : ' + (calculTmp));
							
							
							$('#progress_Normal').css('width', (r.progress() * 100) + '%');
							$('#pourcentageUpload').text(progression);
							$('title').text(parseInt((r.progress() * 100)) + '% ' + nomFinal);
							
							if (((progression) >= 10) &&((progression) < 15) && (calculTmp == 0))
							{
								var unite = {sec: 60, min: 60, hour: 24};
								var tab = {};
								
								tab.tmp = countManager.getTmp()
								tab.tmp = ((tab.tmp * 10) + ((tab.tmp * 10)* 0.25));
								
								tab.day = Math.floor(tab.tmp / (unite.hour * unite.min * unite.sec));
								tab.hour = Math.floor(tab.tmp / (unite.min * unite.sec)) % unite.hour;
								tab.min = Math.floor(tab.tmp / (unite.sec)) % unite.min;
								tab.sec = tab.tmp % unite.sec;
								
								$('#temps_Estimer_Sec').text(parseInt(tab.sec));
								$('#temps_Estimer_Min').text(parseInt(tab.min));
								$('#temps_Estimer_Hour').text(parseInt(tab.hour));
								$('#temps_Estimer_Day').text(parseInt(tab.day));
								
								calculTmp = 1;
							}
							else if (((progression) >= 15) && (calculTmp == 0))
							{
								$('#temps_Estimer_Sec').text('15');
								$('#temps_Estimer_Min').text('0');
								$('#temps_Estimer_Hour').text('0');
								$('#temps_Estimer_Day').text('0');
							}
						  });
						  
						r.on('chunkingStart', function(file){
						
						  });
						  
						r.on('chunkingProgress', function(file, ratio){
							//console.debug('chunkingProgress : ' + (ratio * 100));
							$('#progress_Chunking').css('width', (ratio * 100) + '%');
							$('#pourcentageChungink').text((ratio * 100).toFixed(2));
						  });
						  
						r.on('error', function(message, file){
							console.debug(message, file);
							alert('Error !!');
						  });
						r.on('pause', function(){
							//console.debug('pause : ');
							
							// Arret du compteur
							countManager.stop();
							
							// Désactivation du boutons "Pause" et activation "Resume"
							pause_btn.attr('disabled', true);
							resume_btn.attr('disabled', false);
						  });
						r.on('cancel', function(){
							//console.debug('cancel : ');
							countManager.stop();
							
							// Désactivation de tous les boutons
							resume_btn.attr('disabled', true);
							pause_btn.attr('disabled', true);
							cancel_btn.attr('disabled', true);
						  });
					}
					
				});
				/*
				countDownManager = {
					// Configuration
					targetTime: new Date('2014-10-10 00:00:00'), // Date cible du compte à rebours (00:00:00)
					displayElement: { // Elements HTML où sont affichés les informations
						day:  null,
						hour: null,
						min:  null,
						sec:  null
					},
					
					// Initialisation du compte à rebours (à appeler 1 fois au chargement de la page)
					init: function(){
						// Récupération des références vers les éléments pour l'affichage
						// La référence n'est récupérée qu'une seule fois à l'initialisation pour optimiser les performances
						this.displayElement.day  = jQuery('#remaining_day');
						this.displayElement.hour = jQuery('#remaining_hour');
						this.displayElement.min  = jQuery('#remaining_min');
						this.displayElement.sec  = jQuery('#remaining_sec');
						
						// Lancement du compte à rebours
						this.tick(); // Premier tick tout de suite
						timerDown = window.setInterval("countDownManager.tick();", 1000); // Ticks suivant, répété toutes les secondes (1000 ms)
					},
					
					// arret du compte à rebours
					stop: function(){
						// Récupération des références vers les éléments pour l'affichage
						clearInterval(timerDown);
					},
					
					// Met à jour le compte à rebours (tic d'horloge)
					tick: function(){
						// Instant présent
						var timeNow  = new Date();
						
						// On s'assure que le temps compté ne soit jamais négatif (ce qui est le cas dans le futur de startTime)
						if( timeNow > this.targetTime ){
							countDownManager.stop();
							timeNow = this.targetTime;
						}
						else
						{
							// Calcul du temps passé
							var diff = this.dateDiff(timeNow, this.targetTime);
							
							this.displayElement.day.text(  diff.day  );
							this.displayElement.hour.text( diff.hour );
							this.displayElement.min.text(  diff.min  );
							this.displayElement.sec.text(  diff.sec  );
						}
					},
					
					// Calcul la différence entre 2 dates, en jour/heure/minute/seconde
					dateDiff: function(date1, date2){
						var diff = {};                          // Initialisation du retour
						var tmp = date2 - date1;
						
						tmp = Math.floor(tmp/1000);             // Nombre de secondes entre les 2 dates
						diff.sec = tmp % 60;                    // Extraction du nombre de secondes
						tmp = Math.floor((tmp-diff.sec)/60);    // Nombre de minutes (partie entière)
						diff.min = tmp % 60;                    // Extraction du nombre de minutes
						tmp = Math.floor((tmp-diff.min)/60);    // Nombre d'heures (entières)
						diff.hour = tmp % 24;                   // Extraction du nombre d'heures
						tmp = Math.floor((tmp-diff.hour)/24);   // Nombre de jours restants
						diff.day = tmp;
						
						return diff;
					}
				};
				
				countDownManager.init();
				//*/
				countManager = {
					// Configuration
					time: 0, // Date cible du compte à rebours (00:00:00)
					displayElement: { // Elements HTML où sont affichés les informations
						day:  null,
						hour: null,
						min:  null,
						sec:  null,
						envoyer_day:  null,
						envoyer_hour: null,
						envoyer_min:  null,
						envoyer_sec:  null
					},
					
					// Initialisation du compte à rebours (à appeler 1 fois au chargement de la page)
					init: function(){
						// Récupération des références vers les éléments pour l'affichage
						// La référence n'est récupérée qu'une seule fois à l'initialisation pour optimiser les performances
						if (this.time == 0)
						{
							this.displayElement.day  = jQuery('#count_Day');
							this.displayElement.hour = jQuery('#count_Hour');
							this.displayElement.min  = jQuery('#count_Min');
							this.displayElement.sec  = jQuery('#count_Sec');
							
							this.displayElement.envoyer_day  = jQuery('#temps_Envoyer_Day');
							this.displayElement.envoyer_hour = jQuery('#temps_Envoyer_Hour');
							this.displayElement.envoyer_min  = jQuery('#temps_Envoyer_Min');
							this.displayElement.envoyer_sec  = jQuery('#temps_Envoyer_Sec');
						}
						// Lancement du compte à rebours
						this.tick(); // Premier tick tout de suite
						timer = window.setInterval("countManager.tick();", 1000); // Ticks suivant, répété toutes les secondes (1000 ms)
					},
					
					// arret du compte à rebours
					stop: function(){
						// Récupération des références vers les éléments pour l'affichage
						clearInterval(timer);
					},
					
					// arret du compte à rebours
					raz: function(){
						// Récupération des références vers les éléments pour l'affichage
						this.time = 0;
						
						this.displayElement.day.text('--');
						this.displayElement.hour.text('--');
						this.displayElement.min.text('--');
						this.displayElement.sec.text('--');
					},
					
					// Met à jour le compte à rebours (tic d'horloge)
					tick: function(){
						// Instant présent
						this.time = this.time + 1;
						
						// Calcul du temps passé
						var diff = this.dateDiff(this.time);
						
						this.displayElement.day.text(  diff.day  );
						this.displayElement.hour.text( diff.hour );
						this.displayElement.min.text(  diff.min  );
						this.displayElement.sec.text(  diff.sec  );
						
						this.displayElement.envoyer_day.text(  diff.day  );
						this.displayElement.envoyer_hour.text( diff.hour );
						this.displayElement.envoyer_min.text(  diff.min  );
						this.displayElement.envoyer_sec.text(  diff.sec  );
					},
					
					// Calcul la différence entre 2 dates, en jour/heure/minute/seconde
					dateDiff: function(tmp){
						var unite = {sec: 60, min: 60, hour: 24};
						var diff = {sec: 0, min: 0, hour: 0, day: 0};

						diff.day = Math.floor(tmp / (unite.hour * unite.min * unite.sec));
						diff.hour = Math.floor(tmp / (unite.min * unite.sec)) % unite.hour;
						diff.min = Math.floor(tmp / (unite.sec)) % unite.min;
						diff.sec = tmp % unite.sec;
						
						return diff;
					},
					
					// retourne le nombre de secondes
					getTmp: function(){
						return this.time;
					}
				};
				
				test = {
					init: function(){
						$('#FileUploaded').fadeToggle( "slow", "linear" );
					}
				}
			</script>
		</div>
	</body>
</html>